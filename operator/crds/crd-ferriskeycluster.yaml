apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: ferriskeyclusters.ferriskey.rs
spec:
  group: ferriskey.rs
  names:
    categories: []
    kind: FerrisKeyCluster
    plural: ferriskeyclusters
    shortNames:
    - fkcl
    singular: ferriskeycluster
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: FerrisKey Version
      jsonPath: .spec.version
      name: Version
      type: string
    - description: Number of Replicas
      jsonPath: .spec.replicas
      name: Replicas
      type: integer
    - description: Is the cluster ready?
      jsonPath: .status.ready
      name: Ready
      type: boolean
    - description: Current Phase
      jsonPath: .status.phase
      name: Phase
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Auto-generated derived type for FerrisKeyClusterSpec via `CustomResource`
        properties:
          spec:
            properties:
              api:
                properties:
                  allowedOrigins:
                    description: Allowed origins for CORS
                    items:
                      type: string
                    type: array
                  apiUrl:
                    description: URL for the API service
                    type: string
                  webappUrl:
                    description: URL for the web application
                    type: string
                required:
                - allowedOrigins
                - apiUrl
                - webappUrl
                type: object
              database:
                properties:
                  databaseName:
                    description: 'Optional: Database name override (if not specified in secret)'
                    nullable: true
                    type: string
                  secretRef:
                    description: Reference to a secret containing database credentials
                    properties:
                      name:
                        description: Name of the secret containing database credentials
                        type: string
                      namespace:
                        description: 'Optional: Namespace of the secret (defaults to same namespace as cluster)'
                        nullable: true
                        type: string
                    required:
                    - name
                    type: object
                  sslMode:
                    description: 'Optional: SSL mode for database connection'
                    nullable: true
                    type: string
                required:
                - secretRef
                type: object
              name:
                type: string
              replicas:
                format: uint32
                minimum: 0.0
                type: integer
              version:
                type: string
            required:
            - api
            - database
            - name
            - replicas
            - version
            type: object
          status:
            nullable: true
            properties:
              conditions:
                items:
                  properties:
                    conditionType:
                      type: string
                    lastTransitionTime:
                      type: string
                    message:
                      nullable: true
                      type: string
                    reason:
                      nullable: true
                      type: string
                    status:
                      type: string
                  required:
                  - conditionType
                  - lastTransitionTime
                  - status
                  type: object
                nullable: true
                type: array
              databaseStatus:
                nullable: true
                properties:
                  connected:
                    type: boolean
                  database:
                    nullable: true
                    type: string
                  host:
                    nullable: true
                    type: string
                  lastCheck:
                    nullable: true
                    type: string
                required:
                - connected
                type: object
              message:
                nullable: true
                type: string
              phase:
                nullable: true
                type: string
              ready:
                type: boolean
            required:
            - ready
            type: object
        required:
        - spec
        title: FerrisKeyCluster
        type: object
    served: true
    storage: true
    subresources:
      status: {}
